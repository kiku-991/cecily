<!DOCTYPE html>
<!-- saved from url=(0024)# -->
<html lang="en" xmlns:th="http://www.thymeleaf.org">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<title>KIKUSHOP</title>
<link rel="stylesheet" type="text/css" href="../css/amazeui.css">
<link rel="stylesheet" type="text/css" href="../css/amazeui.switch.css">
<link rel="stylesheet" type="text/css" href="../css/amazeui.chosen.css">
<link rel="stylesheet" type="text/css" href="../css/cropper.min.css">
<link rel="stylesheet" type="text/css"
	href="../css/amazeui.tagsinput.css">
<link rel="stylesheet" type="text/css" href="../css/common.css">
<link rel="stylesheet" type="text/css" href="../css/common(1).css">
<link rel="stylesheet" type="text/css" href="../css/index.css">

<!-- css钩子 -->
<link rel="stylesheet" type="text/css" href="../css/style.css">
<link rel="stylesheet" type="text/css" href="../css/style(1).css">
<link rel="stylesheet" type="text/css" href="../css/iconfont.css">
<link rel="stylesheet" type="text/css" href="../css/style(3).css">
<link rel="stylesheet" type="text/css" href="../css/style(4).css">
<link rel="stylesheet" type="text/css" href="../css/style(5).css">
<link rel="stylesheet" type="text/css" href="../css/style(6).css">
<link rel="stylesheet" type="text/css" href="../css/style(7).css">
<link rel="stylesheet" type="text/css" href="../css/style(8).css">
<link rel="stylesheet" type="text/css" href="../css/style(9).css">
<link rel="stylesheet" type="text/css" href="../css/style(10).css">
<link rel="stylesheet" type="text/css" href="../css/cart.css">
<!-- CSS only -->
<link href="../css/bootstrap.min.css" rel="stylesheet">
<!-- JavaScript Bundle with Popper -->
<script src="../js/bootstrap.bundle.min.js"></script>


<!-- 公共header内钩子 -->
<style type="text/css">
@media only screen and (min-width:640px) {
	.plugins-homemiddleadv-home-adv ul.am-gallery img {
		-webkit-transition: transform .3s ease-in;
		-moz-transition: transform .3s ease-in;
		-ms-transition: transform .3s ease-in;
		-o-transition: transform .3s ease-in;
		transition: transform .3s ease-in;
	}
	.plugins-homemiddleadv-home-adv ul.am-gallery img:hover {
		-ms-transform: translate3d(0px, -3px, 0px);
		-webkit-transform: translate3d(0px, -3px, 0px);
		-o-transform: translate3d(0px, -3px, 0px);
		transform: translate3d(0px, -3px, 0px);
	}
}

@media only screen and (min-width:1025px) {
	.plugins-homemiddleadv-home-adv {
		overflow: hidden;
	}
	.plugins-homemiddleadv-home-adv ul.am-gallery {
		width: calc(100% + 20px);
		margin-left: -10px;
		margin-top: 10px;
	}
}
</style>
<style type="text/css">
#plugins-commongobacktop {
	display: none;
	position: fixed;
	right: 50px;
	bottom: 100px;
	z-index: 100;
	cursor: pointer;
}
</style>
<style type="text/css">
#plugins-expressforkdn-popup p {
	font-size: 16px;
	color: #FF9800;
	font-weight: 500;
	padding: 1rem;
	text-align: center;
	margin: 0;
}

#plugins-expressforkdn-popup .am-list-static>li {
	padding: .8rem 1rem;
}

#plugins-expressforkdn-popup .am-popup-bd {
	padding: 0;
}

#plugins-expressforkdn-popup .am-list>li {
	border: 1px dashed #dedede;
	border-width: 1px 0;
}
</style>
<style type="text/css">
.plugins-touristbuy-nav-top {
	color: #FF5722;
}
</style>

<style>
* {
	box-sizing: border-box;
}

.zoom {
	padding: 50px;
	/* background-color: green; */
	transition: transform .2s;
	width: 200px;
	height: 200px;
	margin: 0 auto;
}

.zoom:hover {
	-ms-transform: scale(1.5); /* IE 9 */
	-webkit-transform: scale(1.5); /* Safari 3-8 */
	transform: scale(1.5);
}
</style>


<style>
table {
	border-collapse: collapse;
	width: 100%;
}

th, td {
	text-align: left;
	padding: 8px;
}

tr:nth-child(even) {
	background-color: #f2f2f2
}

th {
	background-color: #CC3300;
	color: white;
}
</style>


<style>
.stock-add-submit {
	border: 1px solid black;
	background-color: white;
	color: black;
	padding: 3px 10px;
	font-size: 16px;
	cursor: pointer;
}

.stock-add-submit {
	border-color: green;
	color: green;
}

.stock-add-submit:hover {
	background: green;
	color: white;
}

.stock-min-submit {
	border: 1px solid black;
	background-color: white;
	color: black;
	padding: 3px 10px;
	font-size: 16px;
	cursor: pointer;
}

.stock-min-submit {
	border-color: #f44336;
	color: red;
}

.stock-min-submit:hover {
	background: #f44336;
	color: white;
}

.cart-page {
	margin: 10px auto;
}

table {
	width: 100%;
	border-collapse: collapse;
}

.cart-info {
	display: flex;
	flex-wrap: wrap;
}

th {
	font-size: 16px;
	text-align: left;
	padding: 5px;
	color: #fff;
	background: #ff523b;
	font-weight: normal;
}

td {
	padding: 10px 5px;
}

.product-table td {
	border-bottom: 1px solid #c0c0c0;
}

td input {
	width: 50px;
	height: 30px;
	padding: 5px;
}

td a {
	padding: 5px;
	color: #ff523b;
	font-size: 14px;
}

td img {
	width: 80px;
	height: 80px;
	margin-right: 10px;
}

td strong {
	font-size: 15px;
}

.total-price {
	display: flex;
	justify-content: flex-end;
}

.total-price table {
	border-top: 3px solid #ff523b;
	width: 100%;
	max-width: 400px;
}

.total-price td {
	font-size: 20px;
}

td:last-child {
	text-align: right;
}

th:last-child {
	text-align: right;
}

.total-price button-pill {
	width: 200px;
	height: 50px;
	margin-left: 400px;
	background-color: #ff523b;
}

.price-font-size {
	font-size: 200px;
	color: red;
}
</style>




<link href="../cart/css/button.css" rel="stylesheet">
<link href="../cart/css/cart.css" rel="stylesheet">
<link href="../css/WdatePicker.css" rel="stylesheet" type="text/css">
<link href="../css/ueditor.css" type="text/css" rel="stylesheet">
<script src="../js/ZeroClipboard.js.ダウンロード" type="text/javascript"
	defer="defer"></script>
<body data-new-gr-c-s-check-loaded="14.996.0" data-gr-ext-installed=""
	style="padding-top: 0px;">
</head>
<!-- css钩子 -->

<!-- 公共header内钩子 -->


<!-- header top nav -->
<!-- 顶部导航条 start -->
<div th:insert="~{indextmp::top}"></div>
<!-- 顶部导航条 end -->

<!-- search -->
<!-- 搜索框 start -->
<div th:insert="~{indextmp::search}"></div>
<!-- 搜索框 end -->

<!-- header nav -->
<div th:insert="~{indextmp::header}"></div>
<div class="small-container cart-page">
	<div id="shop-List">
		<table class="product-table" id="shopList">
			<tr>
				<th style="display: none;"></th>
				<th>商品</th>
				<th>単価</th>
				<th>数量</th>
				<th>金額</th>
				<th>操作</th>
			</tr>
			<tr th:if="${proAndCart}!=null" th:each="item :${proAndCart}">
				<td>
					<div class="cart-info">
						<input type="checkbox" class="productbox" name="productbox"
							th:onclick="|changeStatus(${item.productId})|"> <img
							th:src="${item.productImg}" alt="加载中...">

						<p class="goods-title" th:text="${item.productName}"></p>
						<br> <br>

					</div>
				</td>
				<td><small><strong>￥</strong><strong
						class="total-price-content" th:text="${item.productPrice}"></strong></small></td>
				<td>
					<div class="quantity">

						<input type="button" id="min" class="stock-min-submit" value="-"
							th:onclick="|Descre(${item.productId})|" /> <input
							th:id="'text'+${item.productId}" name="quantity" type="text"
							th:value="${item.quantity}" /> <input type="button"
							id="${item.productId}" class="stock-add-submit" value="+"
							th:onclick="|Incre(${item.productId})|" />

					</div>
				</td>
				<td ><strong th:id="'price'+${item.productId}"
					style="color: red; font-size: 20px;" th:text="${item.total}"></strong></td>
				<td>
					<!--  <a th:href="@{/deleteCart/{productId}(productId=${item.productId})}">削除</a>-->
					<button type="button" class="button button-caution button-tiny"
						data-bs-toggle="modal"
						th:data-bs-target="'#staticBackdrop'+${item.productId}">削除</button>

					<!-- Button trigger modal --> <!-- Modal -->
					<div class="modal fade" th:id="'staticBackdrop'+${item.productId}"
						tabindex="-1" aria-labelledby="staticBackdropLabel"
						aria-hidden="true">
						<div class="modal-dialog">
							<div class="modal-content">
								<div class="modal-header">
									<h5 class="modal-title" id="staticBackdropLabel">削除の確認</h5>
									<button type="button" class="btn-close" data-bs-dismiss="modal"
										aria-label="Close"></button>
								</div>

								<div class="modal-body">
									<form
										th:action="@{/myCart/deleteCart/{productId}(productId=${item.productId})}"
										method="post">

										<p>この商品を買い物かごに削除しますか？</p>
										<div class="modal-footer">
											<button type="button" class="btn btn-secondary"
												data-bs-dismiss="modal">キャンセル</button>
											<input type="submit" id="kakutei" class="btn btn-danger"
												value="確定">
										</div>
									</form>
								</div>
							</div>
						</div>
					</div>

				</td>
			</tr>
		</table>
	</div>

	<input type="checkbox" class="checkbox" name="allbox"
		th:onclick="changeAllStatus()" /> 全选

	<div class="cart-nav"
		style="position: relative; bottom: 0px; z-index: 0; width: 100%;">
		<div class="am-fl nav-left am-margin-left-xs">

			<a href="#" class="am-margin-left-sm nav-delete-submit submit-ajax"
				data-url="" data-id="2856,2855" data-view="reload"
				data-msg="删除后不可恢复、确认操作吗？"></a>

			<!-- 导航左侧内部 开始 -->
			<!-- 导航左侧内部 结束 -->
		</div>
		<div class="am-fr nav-right">
			<!-- 导航右侧内部 开始 -->
			<!-- 导航右侧内部 结束 -->

			<form th:action="@{/mycart/buy}" method="post" class="am-fr">
				<span  class="selected-tips am-fl"><span>已选商品</span>
					<strong id="jianshu"></strong> <span>件</span></span> <span
					class="total-price-tips am-fl">合计：</span> <strong id="gokei"></strong>
				<input type="hidden" name="ids" value="2856,2855"> <input
					type="hidden" name="buy_type" value="cart">
				<button type="submit" id ="keisan" class="am-btn am-btn-primary separate-submit " disabled="disabled">结算</button>
			</form>
		</div>
	</div>
</div>


<!-- 当前控制器js -->
<script type="text/javascript" src="../js/cart.js.ダウンロード"></script>



<!-- <script
	src="https://ajax.googleapis.com/ajax/libs/jquery/3.4.1/jquery.min.js"></script> -->
<script src="../ajax/jquery.min.js"></script>
<!-- 全選処理 -->
<script>
	function changeAllStatus() {

		var all = document.getElementsByName("allbox");
		var single = document.getElementsByName("productbox");
		var fag = false;
		if (all[0].checked == false) {
			fag = false;
			for (var i = 0; i < single.length; i++) {
				single[i].checked = false;//将所有复选框设置为不选中
				$('#keisan').attr("disabled",true);
			}

		} else {
			fag = true;
			for (var i = 0; i < single.length; i++) {//否则将所有复选框设置为选中
				single[i].checked = true;
				$('#keisan').removeAttr("disabled");
			}
		}
		var flag = {
			flg : fag
		};

		$.ajax({
			url : '/changeAllStatus',
			type : 'POST',
			timeout : 60000,
			data : flag,
			async : false,
			dataType : "json"
		})
		//Ajax通信成功の場合
		.done(function(data) {

			var amount = data.amount;
			var quantity = data.quantity;

			$("#jianshu").text(quantity);
			$("#gokei").text(amount);
			

		})
		//Ajax通信失敗の場合
		.fail(function() {
			alert("---");
		})
		//Ajax通信の成功・失敗に関わらず最後に処理
		.always(function() {

		});

	}
</script>



<!-- 買い物かごSINGLEチェックボックス処理 -->
<script>
	function changeStatus(productId) {
		var p = {
			id : productId
		};

		$.ajax({

			url : '/changeStatus',
			type : 'POST',
			timeout : 60000,
			data : p,
			async : false,
			dataType : "json"
		})
		//Ajax通信成功の場合
		.done(function(data) {

			var amount = data.amount;
			var quantity = data.quantity;

			$("#jianshu").text(quantity);
			$("#gokei").text(amount);
			
			
			if(quantity==0){
				$('#keisan').attr("disabled",true);
			}else{
				$('#keisan').removeAttr("disabled");
			}
			

		})
		//Ajax通信失敗の場合
		.fail(function() {
			alert('失敗しました!');
		})
		//Ajax通信の成功・失敗に関わらず最後に処理
		.always(function() {

		});

	}
</script>

<script>
	//'+'ボタンを押下処理
	function Incre(productId) {
		var oldValue = $('#text' + productId).val();
		var newVal = parseInt(oldValue) + 1;

		var p = {
			id : productId
		};

		$.ajax({
			//MainControllerのpostIndex()メソッドに遷移
			url : '/increse',
			type : 'POST',
			timeout : 60000,
			data : p,
			async : false,
			dataType : "json"
		})
		//Ajax通信成功の場合
		.done(function(data) {
			var total = data.total;
			var msg = data.check;
			if (msg != 0) {

				$('#text' + productId).val(newVal);
				$('#price' + productId).text(total);
				//window.location.href = "/shopping/myCart"
			} else {
				$('#price' + productId).text(total);
				alert('該商品のストックを超えるため,追加できません');
				window.location.href = "/shopping/myCart"
			}

		})
		//Ajax通信失敗の場合
		.fail(function() {
			alert('失敗しました!');
		})
		//Ajax通信の成功・失敗に関わらず最後に処理
		.always(function() {

		});

	}

	//'-'ボタンを押下処理
	function Descre(productId) {
		var oldValue = $('#text' + productId).val();
		var newVal = parseInt(oldValue) - 1;

		var p = {
			id : productId
		};

		$.ajax({
			//MainControllerのpostIndex()メソッドに遷移
			url : '/descre',
			type : 'POST',
			timeout : 60000,
			data : p,
			async : false,
			dataType : "json"
		})
		//Ajax通信成功の場合
		.done(function(data) {

			if (data != 0) {
				$('#text' + productId).val(newVal);
				$('#price' + productId).text(data)
				//window.location.href = "/shopping/myCart"
			}

			window.location.href = "/shopping/myCart"

		})
		//Ajax通信失敗の場合
		.fail(function() {
			alert('失敗しました!');
		})
		//Ajax通信の成功・失敗に関わらず最後に処理
		.always(function() {

		});

	}
</script>







<!-- 图片放大镜 -->
<script type="text/javascript"
	src="../js/jquery.imagezoom.min.js.ダウンロード"></script>

<!-- echarts 图表 -->
<script type="text/javascript" src="../js/echarts.min.js.ダウンロード"></script>
<script type="text/javascript" src="../js/macarons.js.ダウンロード"></script>

<!-- amazeui插件 -->
<script type="text/javascript" src="../js/amazeui.switch.min.js.ダウンロード"></script>
<script type="text/javascript" src="../js/amazeui.chosen.min.js.ダウンロード"></script>
<script type="text/javascript" src="../js/amazeui.dialog.js.ダウンロード"></script>
<script type="text/javascript"
	src="../js/amazeui.tagsinput.min.js.ダウンロード"></script>

<!-- 图像裁剪插件 -->
<!-- <script type="text/javascript" src="../index/js/cropper.min.js.ダウンロード"></script> -->

<!-- 复制插件 -->
<script type="text/javascript" src="../js/clipboard.min.js.ダウンロード"></script>

<!-- 元素拖拽排序插件 -->
<script type="text/javascript"
	src="../js/jquery.dragsort-0.5.2.min.js.ダウンロード"></script>

<!-- ueditor 编辑器 -->
<script type="text/javascript" src="../js/ueditor.config.js.ダウンロード"></script>
<script type="text/javascript" src="../js/ueditor.all.js.ダウンロード"></script>
<script type="text/javascript" src="../js/zh-cn.js.ダウンロード"></script>

<!-- 颜色选择器 -->
<script type="text/javascript" src="../js/jquery.colorpicker.js.ダウンロード"></script>

<!-- 日期组件 -->
<script type="text/javascript" src="../js/WdatePicker.js.ダウンロード"></script>

<!-- baidu map -->
<script type="text/javascript" src="../js/api"></script>
<script type="text/javascript" src="../js/getscript"></script>

<!-- 项目公共 -->
<script type="text/javascript" src="../js/common.js.ダウンロード"></script>
<script type="text/javascript" src="../js/common.js(1).ダウンロード"></script>

<!-- 当前控制器js -->
<script type="text/javascript" src="../js/index.js.ダウンロード"></script>



<!-- js钩子 -->
<script type="text/javascript" src="../js/style.js.ダウンロード"></script>
<script type="text/javascript" src="../js/style.js(1).ダウンロード"></script>

<script type="text/javascript" src="../js/style.js(2).ダウンロード"></script>
<script type="text/javascript" src="../js/style.js(3).ダウンロード"></script>
<script type="text/javascript" src="../js/style.js(4).ダウンロード"></script>






</body>
</html>